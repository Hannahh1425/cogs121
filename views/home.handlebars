<!-- This is our home page.
    For the trend section, we directly generate the template from backend
    when making api call to get the trend data.
 -->
<link rel="stylesheet" href="/style.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="/trends.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">


<script>

  $(document).ready(function() {
    $(window).bind("pageshow", function(event) {
      if (event.originalEvent.persisted) {
          console.log("persist");
          window.location.reload();
      }
    });

    $.ajax('/fetchData', {
      method: 'get'
    })
    .then(
      function success(json) {
        console.log("requesting to fetch data!");
        console.log("success");
        console.log(json.row);
        let rows = json.row;
        $.each(rows, function(i, item) {
          let icon = json.star;
          console.log("iconnn");
          console.log(icon[i]);
          let titleLike = 'title' + i;
          let contentLike = 'content' + i;
          let layoutLike = 'layout' + i;
          let hidetitle = rows[i].title;

          $(".all_articles").append('<div id="' + rows[i].id + '" class="article'+ i +' art"></div>');
          $("<button class=add_article id=" + i + " name=\"" + rows[i].title + "\" value=\"" + rows[i].link + "\"><i id=icon" + i + " class=\"" + icon[i] + "\"></i></button>" ).appendTo( '.article' + i);
          $('<div id=myModal' + i + ' class="hidden"><a href="/source"><u id=mark' + i + '>Bookmarked!</u></a></div>').appendTo('.article' + i);
          $('<a href="' + rows[i].link + '">'+rows[i].title+'</a>').appendTo( '.article' + i);
          $("<p>" + rows[i].author + '&nbsp&nbsp&nbsp&nbsp&nbsp' + rows[i].reading_time +' min read '+'&nbsp&nbsp&nbsp&nbsp&nbsp'+rows[i].claps+ '&nbsp'+ 'claps'+ "</p>").appendTo( '.article' + i);
          $('<button class = "btneach btntitle" id = ' + titleLike + ' onclick="updateLikeTitle(' + rows[i].id + ')">Title  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_title +'</button>' ).appendTo( '.article' + i);
          $('<button class = "btneach btncontent" id = ' + contentLike + ' onclick="updateLikeContent(' + rows[i].id + ')">Content  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+ rows[i].like_content +'</button>' ).appendTo( '.article' + i);
          $('<button class = "btneach btnlayout" id = ' + layoutLike + ' onclick="updateLikeLayout(' + rows[i].id + ')">Layout  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_layout +'</button>' ).appendTo( '.article' + i);

        })

        $('<button class = "expandbtn" onclick="expand1()"><i class="fas fa-chevron-down"></i><p> View More</p></button>').appendTo('.all_articles');

      },
      function fail(data, status) {
        console.log("fail");
        console.log(data);
        alert('Request failed.  Returned status of ' + status);
      }
    );

    $.ajax('/fetchArticle', {
      method: 'get'
    })
    .then(
      function success(json) {
        console.log("requesting to fetch Article starts!");
        console.log(json);

          $('<a href="' + json[0].link + '">'+json[0].title+'</a>'+'<br>').appendTo('.daily_push');
          $('<a style="font-size:15px;color:grey">' + json[0].author + "</a>").appendTo('.daily_push');//append author and reading time

          $('<a href="' + json[2].link + '">'+json[2].title+'</a>'+'<br>').appendTo('.daily_push1');
          $('<a style="font-size:15px;color:grey">' + json[2].author + "</a>").appendTo('.daily_push1');//append author and reading time



      },
      function fail(data, status) {
        console.log("fail");
        console.log(data);
        alert('Request failed.  Returned status of ' + status);
      }
    );


    $.ajax({
    url: '/latest_reading',
    method: 'get'
    })

    .then(
      function success(json) {
        console.log("requesting to latest!");
        console.log(json);
        let average = 0;
        $.each(json, function(i, item) {

          average = json[i].reading_time + average;


        })

        let final = average/40;
        console.log(final);
        $('#latest_reading').html(final);



      },

      function fail(data, status) {
        console.log("fail");
        console.log(data);
        alert('Request failed.  Returned status of ' + status);
      }
    );




  });


  $('body').on('click', '.add_article', function (e) {
    console.log("clititlekkked");
    e.preventDefault();
    var title = this.name;
    var link = this.value;
    var id = this.id;
    console.log(id);

    $.ajax({
      // all URLs are relative to http://localhost:3000/
      url: '/bookmarks',
      type: 'POST', // <-- this is POST, not GET
      data: {
              title: title,
              link: link
            },
      success: (data) => {
        let modal = '#myModal' + id;
        let icon = '#icon' + id;
        $(icon).removeClass("far fa-star");
        $(icon).addClass("fas fa-star");
        console.log($('#myModal').attr("class"));
        $(modal).removeClass("hidden");
        $(modal).addClass("show_home");
        setTimeout(function() {
          $(modal).removeClass("show_home");
          $(modal).addClass("hidden");
        }, 2000);
      }
    });
  });

  $('body').on('mouseover', '.trend-data', function() {
    const id = this.id;
    $('#' + id).addClass("trend_animation");
  });

  $('body').on('mouseleave', '.trend-data', function() {
    const id = this.id;
    $('#' + id).removeClass("trend_animation");
  });



updateLikeTitle = (id) => {
  console.log("function called")
  $.ajax({
    url: '/updateLikeTitle',
    type: 'POST',
    dataType : 'json',

    data: {
      article_id: id
    },
    success: (data) => {

      let pass = '#title' + id;
      $(pass).html('Title  ' +'<i class="fas fa-thumbs-up"></i>'+'&nbsp'+ data.newLikes);

      console.log("successfully reload idex.html")

    }
  });
}


updateLikeContent = (id) => {
  $.ajax({
    url: '/updateLikeContent',
    type: 'POST',
    dataType : 'json',

    data: {
      article_id: id
    },
    success: (data) => {

      let pass = '#content' + id;
      $(pass).html('Content  ' +'<i class="fas fa-thumbs-up"></i>'+'&nbsp'+ data.newLikes);

      console.log("successfully reload idex.html")

    }
  });
}

updateLikeLayout = (id) => {
  $.ajax({
    url: '/updateLikeLayout',
    type: 'POST',
    dataType : 'json',

    data: {
      article_id: id
    },
    success: (data) => {


      let pass = '#layout' + id;
      $(pass).html('Layout  ' + '<i class="fas fa-thumbs-up"></i>'+'&nbsp'+data.newLikes);

      console.log("successfully reload idex.html")

    }
  });
}



sort_title = () => {

  $.ajax({
    url: '/sort_by_title',
    type: 'POST',

  })
  .then(
    function success(json) {
      console.log("success0");
      console.log(json);
      $('.all_articles').empty();
      console.log(json.row);
      let rows = json.row;
      $.each(rows, function(i, item) {

        let icon = json.star;
        console.log("iconnn");
        console.log(icon[i]);
        let titleLike = 'title' + i;
        let contentLike = 'content' + i;
        let layoutLike = 'layout' + i;
        let hidetitle = rows[i].title;

        $(".all_articles").append('<div id="' + rows[i].id + '" class="article'+ i +' art"></div>');
        $("<button class=add_article id=" + i + " name=\"" + rows[i].title + "\" value=\"" + rows[i].link + "\"><i id=icon" + i + " class=\"" + icon[i] + "\"></i></button>" ).appendTo( '.article' + i);
        $('<div id=myModal' + i + ' class="hidden"><a href="/source"><u id=mark' + i + '>Bookmarked!</u></a></div>').appendTo('.article' + i);
        $('<a href="' + rows[i].link + '">'+rows[i].title+'</a>').appendTo( '.article' + i);
        $("<p>" + rows[i].author + '&nbsp&nbsp&nbsp&nbsp&nbsp' + rows[i].reading_time +' min read '+'&nbsp&nbsp&nbsp&nbsp&nbsp'+rows[i].claps+ '&nbsp'+ 'claps'+ "</p>").appendTo( '.article' + i);
        $('<button class = "btneach btntitle" id = ' + titleLike + ' onclick="updateLikeTitle(' + rows[i].id + ')">Title  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_title +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btncontent" id = ' + contentLike + ' onclick="updateLikeContent(' + rows[i].id + ')">Content  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+ rows[i].like_content +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btnlayout" id = ' + layoutLike + ' onclick="updateLikeLayout(' + rows[i].id + ')">Layout  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_layout +'</button>' ).appendTo( '.article' + i);

      })
      $('<button class = "expandbtn" onclick="expand1_sort_title()"><i class="fas fa-chevron-down"></i><p>View More</p></button>').appendTo('.all_articles');

    },


    function fail(data, status) {
      console.log("fail");
      console.log(data);
      alert('Request failed.  Returned status of ' + status);
    }
  );

}

sort_content = () => {

  $.ajax({
    url: '/sort_by_content',
    type: 'POST',

  })
  .then(
    function success(json) {
      console.log("success0");
      console.log(json);
      $('.all_articles').empty();
      console.log(json.row);
      let rows = json.row;
      $.each(rows, function(i, item) {

        let icon = json.star;
        console.log("iconnn");
        console.log(icon[i]);
        let titleLike = 'title' + i;
        let contentLike = 'content' + i;
        let layoutLike = 'layout' + i;
        let hidetitle = rows[i].title;

        $(".all_articles").append('<div id="' + rows[i].id + '" class="article'+ i +' art"></div>');
        $("<button class=add_article id=" + i + " name=\"" + rows[i].title + "\" value=\"" + rows[i].link + "\"><i id=icon" + i + " class=\"" + icon[i] + "\"></i></button>" ).appendTo( '.article' + i);
        $('<div id=myModal' + i + ' class="hidden"><a href="/source"><u id=mark' + i + '>Bookmarked!</u></a></div>').appendTo('.article' + i);
        $('<a href="' + rows[i].link + '">'+rows[i].title+'</a>').appendTo( '.article' + i);
        $("<p>" + rows[i].author + '&nbsp&nbsp&nbsp&nbsp&nbsp' + rows[i].reading_time +' min read '+'&nbsp&nbsp&nbsp&nbsp&nbsp'+rows[i].claps+ '&nbsp'+ 'claps'+ "</p>").appendTo( '.article' + i);
        $('<button class = "btneach btntitle" id = ' + titleLike + ' onclick="updateLikeTitle(' + rows[i].id + ')">Title  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_title +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btncontent" id = ' + contentLike + ' onclick="updateLikeContent(' + rows[i].id + ')">Content  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+ rows[i].like_content +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btnlayout" id = ' + layoutLike + ' onclick="updateLikeLayout(' + rows[i].id + ')">Layout  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_layout +'</button>' ).appendTo( '.article' + i);

      })
      $('<button class = "expandbtn" onclick="expand1_sort_content()"><i class="fas fa-chevron-down"></i><p>View More</p></button>').appendTo('.all_articles');

    },


    function fail(data, status) {
      console.log("fail");
      console.log(data);
      alert('Request failed.  Returned status of ' + status);
    }
  );


}


sort_layout = () => {

  $.ajax({
    url: '/sort_by_layout',
    type: 'POST',

  })
  .then(
    function success(json) {
      console.log("success0");
      console.log(json);
      $('.all_articles').empty();
      console.log(json.row);
      let rows = json.row;
      $.each(rows, function(i, item) {

        let icon = json.star;
        console.log("iconnn");
        console.log(icon[i]);
        let titleLike = 'title' + i;
        let contentLike = 'content' + i;
        let layoutLike = 'layout' + i;
        let hidetitle = rows[i].title;
        $(".all_articles").append('<div id="' + rows[i].id + '" class="article'+ i +' art"></div>');
        $("<button class=add_article id=" + i + " name=\"" + rows[i].title + "\" value=\"" + rows[i].link + "\"><i id=icon" + i + " class=\"" + icon[i] + "\"></i></button>" ).appendTo( '.article' + i);
        $('<div id=myModal' + i + ' class="hidden"><a href="/source"><u id=mark' + i + '>Bookmarked!</u></a></div>').appendTo('.article' + i);
        $('<a href="' + rows[i].link + '">'+rows[i].title+'</a>').appendTo( '.article' + i);
        $("<p>" + rows[i].author + '&nbsp&nbsp&nbsp&nbsp&nbsp' + rows[i].reading_time +' min read '+'&nbsp&nbsp&nbsp&nbsp&nbsp'+rows[i].claps+ '&nbsp'+ 'claps'+ "</p>").appendTo( '.article' + i);
        $('<button class = "btneach btntitle" id = ' + titleLike + ' onclick="updateLikeTitle(' + rows[i].id + ')">Title  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_title +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btncontent" id = ' + contentLike + ' onclick="updateLikeContent(' + rows[i].id + ')">Content  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+ rows[i].like_content +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btnlayout" id = ' + layoutLike + ' onclick="updateLikeLayout(' + rows[i].id + ')">Layout  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_layout +'</button>' ).appendTo( '.article' + i);

      })

      $('<button class = "expandbtn" onclick="expand1_sort_layout()"><i class="fas fa-chevron-down"></i><p>View More</p></button>').appendTo('.all_articles');

    },


    function fail(data, status) {
      console.log("fail");
      console.log(data);
      alert('Request failed.  Returned status of ' + status);
    }
  );


}

expand1 = () => {

  $.ajax({
    url: '/expand1',
    type: 'POST',

  })
  .then(
    function success(json) {
      console.log("expand1 starts");
      console.log(json);
      $('.all_articles').empty();
      console.log(json.row);
      let rows = json.row;
      $.each(rows, function(i, item) {

        let icon = json.star;
        console.log("iconnn");
        console.log(icon[i]);
        let titleLike = 'title' + i;
        let contentLike = 'content' + i;
        let layoutLike = 'layout' + i;
        let hidetitle = rows[i].title;

        $(".all_articles").append('<div id="' + rows[i].id + '" class="article'+ i +' art"></div>');
        $("<button class=add_article id=" + i + " name=\"" + rows[i].title + "\" value=\"" + rows[i].link + "\"><i id=icon" + i + " class=\"" + icon[i] + "\"></i></button>" ).appendTo( '.article' + i);
        $('<div id=myModal' + i + ' class="hidden"><a href="/source"><u id=mark' + i + '>Bookmarked!</u></a></div>').appendTo('.article' + i);
        $('<a href="' + rows[i].link + '">'+rows[i].title+'</a>').appendTo( '.article' + i);
        $("<p>" + rows[i].author + '&nbsp&nbsp&nbsp&nbsp&nbsp' + rows[i].reading_time +' min read '+'&nbsp&nbsp&nbsp&nbsp&nbsp'+rows[i].claps+ '&nbsp'+ 'claps'+ "</p>").appendTo( '.article' + i);
        $('<button class = "btneach btntitle" id = ' + titleLike + ' onclick="updateLikeTitle(' + rows[i].id + ')">Title  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_title +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btncontent" id = ' + contentLike + ' onclick="updateLikeContent(' + rows[i].id + ')">Content  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+ rows[i].like_content +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btnlayout" id = ' + layoutLike + ' onclick="updateLikeLayout(' + rows[i].id + ')">Layout  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_layout +'</button>' ).appendTo( '.article' + i);

      })

      $('<button class = "expandbtn" onclick="expand2()"><i class="fas fa-chevron-down"></i><p>ALL</p></button>').appendTo('.all_articles');

    },


    function fail(data, status) {
      console.log("fail");
      console.log(data);
      alert('Expand Request failed.  Returned status of ' + status);
    }
  );


}

expand1_sort_title = () => {

  $.ajax({
    url: '/expand1_sort_title',
    type: 'POST',

  })
  .then(
    function success(json) {
      console.log("expand1 title starts");
      console.log(json);
      $('.all_articles').empty();
      console.log(json.row);
      let rows = json.row;
      $.each(rows, function(i, item) {

        let icon = json.star;
        console.log("iconnn");
        console.log(icon[i]);
        let titleLike = 'title' + i;
        let contentLike = 'content' + i;
        let layoutLike = 'layout' + i;
        let hidetitle = rows[i].title;

        $(".all_articles").append('<div id="' + rows[i].id + '" class="article'+ i +' art"></div>');
        $("<button class=add_article id=" + i + " name=\"" + rows[i].title + "\" value=\"" + rows[i].link + "\"><i id=icon" + i + " class=\"" + icon[i] + "\"></i></button>" ).appendTo( '.article' + i);
        $('<div id=myModal' + i + ' class="hidden"><a href="/source"><u id=mark' + i + '>Bookmarked!</u></a></div>').appendTo('.article' + i);
        $('<a href="' + rows[i].link + '">'+rows[i].title+'</a>').appendTo( '.article' + i);
        $("<p>" + rows[i].author + '&nbsp&nbsp&nbsp&nbsp&nbsp' + rows[i].reading_time +' min read '+'&nbsp&nbsp&nbsp&nbsp&nbsp'+rows[i].claps+ '&nbsp'+ 'claps'+ "</p>").appendTo( '.article' + i);
        $('<button class = "btneach btntitle" id = ' + titleLike + ' onclick="updateLikeTitle(' + rows[i].id + ')">Title  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_title +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btncontent" id = ' + contentLike + ' onclick="updateLikeContent(' + rows[i].id + ')">Content  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+ rows[i].like_content +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btnlayout" id = ' + layoutLike + ' onclick="updateLikeLayout(' + rows[i].id + ')">Layout  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_layout +'</button>' ).appendTo( '.article' + i);

      })

      $('<button class = "expandbtn" onclick="expand2_sort_title()"><i class="fas fa-chevron-down"></i><p>ALL</p></button>').appendTo('.all_articles');

    },


    function fail(data, status) {
      console.log("fail");
      console.log(data);
      alert('Expand Request failed.  Returned status of ' + status);
    }
  );


}

expand2_sort_title = () => {

  $.ajax({
    url: '/expand2_sort_title',
    type: 'POST',

  })
  .then(
    function success(json) {
      console.log("expand2 title starts");
      console.log(json);
      $('.all_articles').empty();
      console.log(json.row);
      let rows = json.row;
      $.each(rows, function(i, item) {

        let icon = json.star;
        console.log("iconnn");
        console.log(icon[i]);
        let titleLike = 'title' + i;
        let contentLike = 'content' + i;
        let layoutLike = 'layout' + i;
        let hidetitle = rows[i].title;

        $(".all_articles").append('<div id="' + rows[i].id + '" class="article'+ i +' art"></div>');
        $("<button class=add_article id=" + i + " name=\"" + rows[i].title + "\" value=\"" + rows[i].link + "\"><i id=icon" + i + " class=\"" + icon[i] + "\"></i></button>" ).appendTo( '.article' + i);
        $('<div id=myModal' + i + ' class="hidden"><a href="/source"><u id=mark' + i + '>Bookmarked!</u></a></div>').appendTo('.article' + i);
        $('<a href="' + rows[i].link + '">'+rows[i].title+'</a>').appendTo( '.article' + i);
        $("<p>" + rows[i].author + '&nbsp&nbsp&nbsp&nbsp&nbsp' + rows[i].reading_time +' min read '+'&nbsp&nbsp&nbsp&nbsp&nbsp'+rows[i].claps+ '&nbsp'+ 'claps'+ "</p>").appendTo( '.article' + i);
        $('<button class = "btneach btntitle" id = ' + titleLike + ' onclick="updateLikeTitle(' + rows[i].id + ')">Title  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_title +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btncontent" id = ' + contentLike + ' onclick="updateLikeContent(' + rows[i].id + ')">Content  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+ rows[i].like_content +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btnlayout" id = ' + layoutLike + ' onclick="updateLikeLayout(' + rows[i].id + ')">Layout  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_layout +'</button>' ).appendTo( '.article' + i);

      })



    },


    function fail(data, status) {
      console.log("fail");
      console.log(data);
      alert('Expand Request failed.  Returned status of ' + status);
    }
  );


}


expand1_sort_content = () => {

  $.ajax({
    url: '/expand1_sort_content',
    type: 'POST',

  })
  .then(
    function success(json) {
      console.log("expand1 content starts");
      console.log(json);
      $('.all_articles').empty();
      console.log(json.row);
      let rows = json.row;
      $.each(rows, function(i, item) {

        let icon = json.star;
        console.log("iconnn");
        console.log(icon[i]);
        let titleLike = 'title' + i;
        let contentLike = 'content' + i;
        let layoutLike = 'layout' + i;
        let hidetitle = rows[i].title;

        $(".all_articles").append('<div id="' + rows[i].id + '" class="article'+ i +' art"></div>');
        $("<button class=add_article id=" + i + " name=\"" + rows[i].title + "\" value=\"" + rows[i].link + "\"><i id=icon" + i + " class=\"" + icon[i] + "\"></i></button>" ).appendTo( '.article' + i);
        $('<div id=myModal' + i + ' class="hidden"><a href="/source"><u id=mark' + i + '>Bookmarked!</u></a></div>').appendTo('.article' + i);
        $('<a href="' + rows[i].link + '">'+rows[i].title+'</a>').appendTo( '.article' + i);
        $("<p>" + rows[i].author + '&nbsp&nbsp&nbsp&nbsp&nbsp' + rows[i].reading_time +' min read '+'&nbsp&nbsp&nbsp&nbsp&nbsp'+rows[i].claps+ '&nbsp'+ 'claps'+ "</p>").appendTo( '.article' + i);
        $('<button class = "btneach btntitle" id = ' + titleLike + ' onclick="updateLikeTitle(' + rows[i].id + ')">Title  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_title +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btncontent" id = ' + contentLike + ' onclick="updateLikeContent(' + rows[i].id + ')">Content  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+ rows[i].like_content +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btnlayout" id = ' + layoutLike + ' onclick="updateLikeLayout(' + rows[i].id + ')">Layout  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_layout +'</button>' ).appendTo( '.article' + i);
      })

      $('<button class = "expandbtn" onclick="expand2_sort_content()"><i class="fas fa-chevron-down"></i><p>ALL</p></button>').appendTo('.all_articles');

    },


    function fail(data, status) {
      console.log("fail");
      console.log(data);
      alert('Expand Request failed.  Returned status of ' + status);
    }
  );


}

expand2_sort_content = () => {

  $.ajax({
    url: '/expand2_sort_content',
    type: 'POST',

  })
  .then(
    function success(json) {
      console.log("expand1 content starts");
      console.log(json);
      $('.all_articles').empty();
      console.log(json.row);
      let rows = json.row;
      $.each(rows, function(i, item) {

        let icon = json.star;
        console.log("iconnn");
        console.log(icon[i]);
        let titleLike = 'title' + i;
        let contentLike = 'content' + i;
        let layoutLike = 'layout' + i;
        let hidetitle = rows[i].title;

        $(".all_articles").append('<div id="' + rows[i].id + '" class="article'+ i +' art"></div>');
        $("<button class=add_article id=" + i + " name=\"" + rows[i].title + "\" value=\"" + rows[i].link + "\"><i id=icon" + i + " class=\"" + icon[i] + "\"></i></button>" ).appendTo( '.article' + i);
        $('<div id=myModal' + i + ' class="hidden"><a href="/source"><u id=mark' + i + '>Bookmarked!</u></a></div>').appendTo('.article' + i);
        $('<a href="' + rows[i].link + '">'+rows[i].title+'</a>').appendTo( '.article' + i);
        $("<p>" + rows[i].author + '&nbsp&nbsp&nbsp&nbsp&nbsp' + rows[i].reading_time +' min read '+'&nbsp&nbsp&nbsp&nbsp&nbsp'+rows[i].claps+ '&nbsp'+ 'claps'+ "</p>").appendTo( '.article' + i);
        $('<button class = "btneach btntitle" id = ' + titleLike + ' onclick="updateLikeTitle(' + rows[i].id + ')">Title  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_title +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btncontent" id = ' + contentLike + ' onclick="updateLikeContent(' + rows[i].id + ')">Content  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+ rows[i].like_content +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btnlayout" id = ' + layoutLike + ' onclick="updateLikeLayout(' + rows[i].id + ')">Layout  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_layout +'</button>' ).appendTo( '.article' + i);

      })


    },


    function fail(data, status) {
      console.log("fail");
      console.log(data);
      alert('Expand Request failed.  Returned status of ' + status);
    }
  );


}



expand1_sort_layout = () => {

  $.ajax({
    url: '/expand1_sort_layout',
    type: 'POST',

  })
  .then(
    function success(json) {
      console.log("expand1 layout starts");
      console.log(json);
      $('.all_articles').empty();
      console.log(json.row);
      let rows = json.row;
      $.each(rows, function(i, item) {

        let icon = json.star;
        console.log("iconnn");
        console.log(icon[i]);
        let titleLike = 'title' + i;
        let contentLike = 'content' + i;
        let layoutLike = 'layout' + i;
        let hidetitle = rows[i].title;

        $(".all_articles").append('<div id="' + rows[i].id + '" class="article'+ i +' art"></div>');
        $("<button class=add_article id=" + i + " name=\"" + rows[i].title + "\" value=\"" + rows[i].link + "\"><i id=icon" + i + " class=\"" + icon[i] + "\"></i></button>" ).appendTo( '.article' + i);
        $('<div id=myModal' + i + ' class="hidden"><a href="/source"><u id=mark' + i + '>Bookmarked!</u></a></div>').appendTo('.article' + i);
        $('<a href="' + rows[i].link + '">'+rows[i].title+'</a>').appendTo( '.article' + i);
        $("<p>" + rows[i].author + '&nbsp&nbsp&nbsp&nbsp&nbsp' + rows[i].reading_time +' min read '+'&nbsp&nbsp&nbsp&nbsp&nbsp'+rows[i].claps+ '&nbsp'+ 'claps'+ "</p>").appendTo( '.article' + i);
        $('<button class = "btneach btntitle" id = ' + titleLike + ' onclick="updateLikeTitle(' + rows[i].id + ')">Title  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_title +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btncontent" id = ' + contentLike + ' onclick="updateLikeContent(' + rows[i].id + ')">Content  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+ rows[i].like_content +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btnlayout" id = ' + layoutLike + ' onclick="updateLikeLayout(' + rows[i].id + ')">Layout  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_layout +'</button>' ).appendTo( '.article' + i);

      })

      $('<button class = "expandbtn" onclick="expand2_sort_layout()"><i class="fas fa-chevron-down"></i><p>ALL</p></button>').appendTo('.all_articles');

    },


    function fail(data, status) {
      console.log("fail");
      console.log(data);
      alert('Expand Request failed.  Returned status of ' + status);
    }
  );


}

expand2_sort_layout = () => {

  $.ajax({
    url: '/expand2_sort_layout',
    type: 'POST',

  })
  .then(
    function success(json) {
      console.log("expand1 layout starts");
      console.log(json);
      $('.all_articles').empty();
      console.log(json.row);
      let rows = json.row;
      $.each(rows, function(i, item) {

        let icon = json.star;
        console.log("iconnn");
        console.log(icon[i]);
        let titleLike = 'title' + i;
        let contentLike = 'content' + i;
        let layoutLike = 'layout' + i;
        let hidetitle = rows[i].title;

        $(".all_articles").append('<div id="' + rows[i].id + '" class="article'+ i +' art"></div>');
        $("<button class=add_article id=" + i + " name=\"" + rows[i].title + "\" value=\"" + rows[i].link + "\"><i id=icon" + i + " class=\"" + icon[i] + "\"></i></button>" ).appendTo( '.article' + i);
        $('<div id=myModal' + i + ' class="hidden"><a href="/source"><u id=mark' + i + '>Bookmarked!</u></a></div>').appendTo('.article' + i);
        $('<a href="' + rows[i].link + '">'+rows[i].title+'</a>').appendTo( '.article' + i);
        $("<p>" + rows[i].author + '&nbsp&nbsp&nbsp&nbsp&nbsp' + rows[i].reading_time +' min read '+'&nbsp&nbsp&nbsp&nbsp&nbsp'+rows[i].claps+ '&nbsp'+ 'claps'+ "</p>").appendTo( '.article' + i);
        $('<button class = "btneach btntitle" id = ' + titleLike + ' onclick="updateLikeTitle(' + rows[i].id + ')">Title  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_title +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btncontent" id = ' + contentLike + ' onclick="updateLikeContent(' + rows[i].id + ')">Content  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+ rows[i].like_content +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btnlayout" id = ' + layoutLike + ' onclick="updateLikeLayout(' + rows[i].id + ')">Layout  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_layout +'</button>' ).appendTo( '.article' + i);

      })


    },


    function fail(data, status) {
      console.log("fail");
      console.log(data);
      alert('Expand Request failed.  Returned status of ' + status);
    }
  );


}



expand2 = () => {

  $.ajax({
    url: '/expand2',
    type: 'POST',

  })
  .then(
    function success(json) {
      console.log("expand2 starts");
      console.log(json);
      $('.all_articles').empty();
      console.log(json.row);
      let rows = json.row;
      $.each(rows, function(i, item) {

        let icon = json.star;
        console.log("iconnn");
        console.log(icon[i]);
        let titleLike = 'title' + i;
        let contentLike = 'content' + i;
        let layoutLike = 'layout' + i;
        let hidetitle = rows[i].title;

        $(".all_articles").append('<div id="' + rows[i].id + '" class="article'+ i +' art"></div>');
        $("<button class=add_article id=" + i + " name=\"" + rows[i].title + "\" value=\"" + rows[i].link + "\"><i id=icon" + i + " class=\"" + icon[i] + "\"></i></button>" ).appendTo( '.article' + i);
        $('<div id=myModal' + i + ' class="hidden"><a href="/source"><u id=mark' + i + '>Bookmarked!</u></a></div>').appendTo('.article' + i);
        $('<a href="' + rows[i].link + '">'+rows[i].title+'</a>').appendTo( '.article' + i);
        $("<p>" + rows[i].author + '&nbsp&nbsp&nbsp&nbsp&nbsp' + rows[i].reading_time +' min read '+'&nbsp&nbsp&nbsp&nbsp&nbsp'+rows[i].claps+ '&nbsp'+ 'claps'+ "</p>").appendTo( '.article' + i);
        $('<button class = "btneach btntitle" id = ' + titleLike + ' onclick="updateLikeTitle(' + rows[i].id + ')">Title  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_title +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btncontent" id = ' + contentLike + ' onclick="updateLikeContent(' + rows[i].id + ')">Content  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+ rows[i].like_content +'</button>' ).appendTo( '.article' + i);
        $('<button class = "btneach btnlayout" id = ' + layoutLike + ' onclick="updateLikeLayout(' + rows[i].id + ')">Layout  '+ '<i class="far fa-thumbs-up"></i>'+'&nbsp'+rows[i].like_layout +'</button>' ).appendTo( '.article' + i);

      })

    },


    function fail(data, status) {
      console.log("fail");
      console.log(data);
      alert('Expand Request failed.  Returned status of ' + status);
    }
  );


}

window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    document.getElementById("myBtn").style.display = "block";
  } else {
    document.getElementById("myBtn").style.display = "none";
  }
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>


{{> homeHeader}}
<div class="content">
<div class="banner">
  <div class="vh-100">
  <h1>Landing</h1>
  <p style="font-size: 40px; font-family: Georgia, Times, Times New Roman, serif; font-style: italic; color:#FD8F3B;">Pack your way of We Media writing</p>
  <br/>

  <!-- <p style="font-size: 25px; color: rgb(245, 190, 59, 0.9);"> ✶ Latest trends &nbsp ✶ Useful writing skills &nbsp ✶ Analysis of successful articles.</p> -->

   </div>
   </div>
<div class="trend">
    <h2>Today's Trends</h2>
    <p>Get everyday's hot topic at the earliest time. Refresh every hour.</p>
    <div class="container">
      {{#each tag as |tag index|}}
        <button class="trend-data" id="tag{{index}}" name="{{tag}}">{{tag}}</button>
      {{/each}}
    </div>

</hr>
</div>



</br>

<div class="push_container">
<h2 style="text-align:center;">Daily skill push</h2>
<div class="daily_push">

  <!-- <p id = "push1"><img src="/public/img/model.jpg" width="42" height="42">How does spotify know you so well?<br>Hello</p> -->
  <img src="push.jpg" width="120" height="120">
  <!-- <p><a href="https://www.w3schools.com/html/">Visit our HTML tutorial</a></p> -->
  <!-- <p id = "push_title">How do you feel about Medium? Spotify...aobgpowinegproiwenrafgop</p>
  <p>How do you feel about Medium? Spotify...aobgpowinegproiwenrafgop</p>
  <p>How do you feel about Medium? Spotify...aobgpowinegproiwenrafgop</p> -->

</div>

<div class="daily_push1">
    <img src="push1.jpg"   width="120" height="120">
</div>
</div>



<!-- <div class="daily_hit_container">
    <h1> Daily Hit </h1>
</div> -->


<div class="article_container">
  <h1>Articles Sources</h1>
  <h4 style="text-align: center; font-weight: 400; padding-top: 30px;">
    At current moment, among the top most popular 50 articles, <br> the average reading time is
    <span style="font-weight:800;font-size:30px;color:#ffd000;" id="latest_reading"></span>
  </h4>
  <br/>
  <!-- Filter button -->

  <div class="dropdown">
    <button class="btn hoverchange dropdown-toggle " type="button" data-toggle="dropdown" style="padding-bottom:20px;font-weight:600">Sort by
    <span class="caret"></span></button>
    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton" style="width: 10%">
      <li><a class="dropdown-item" onclick = "sort_title()">Good Title</a></li>
      <li><a class="dropdown-item" onclick = "sort_content()">Good Content</a></li>
      <li><a class="dropdown-item" onclick = "sort_layout()">Good Layout</a></li>
    </ul>
  </div>



  <div class="all_articles" id = "status">


  </div>

  <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>

</div>

</div>
